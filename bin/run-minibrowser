#!/usr/bin/env python

from build_config import ConfigHelper
from subprocess import call
import os
import sys

config_helper = ConfigHelper()

def main(argv):
  argParser = config_helper.get_argument_parser()
  options = argParser.parse_args()
  minibrowser = os.path.join(config_helper.get_webkit_dir(options), 'bin/MiniBrowser')

  if options.url:
    url = options.url
  else:
    url = 'http://localhost:8000'

  environment = os.environ
  if options.weston:
    environment = config_helper.set_weston_env_for_client(environment)

  if options.llvmpipe:
    environment = config_helper.set_weston_env_for_client(environment)

  jhbuild_cmd = ["jhbuild", "-f", config_helper.jhbuildrc, "run", minibrowser, url]
  call(jhbuild_cmd)

if __name__ == '__main__':
  main(sys.argv)


